{#
node--plant-species--full.html.twig

Tips:
{{ dump() }}
{{ dump(variable_name) }}
{{ dump(_context|keys) }}
#}

{{ attach_library('nmrp_subtheme/taxon') }}

<article{{ attributes }}>

    <div{{ content_attributes }}>

        <!-- DEFAULT IMAGE -->
        {% set defaultimg = node.field_plant_images[0] %}
        {% for key, item in node.field_plant_images %}
            {% if (node.field_plant_images[key].entity.field_image_type[0].entity.name.value == 'D') %}
                {% set defaultimg = node.field_plant_images[key] %}
            {% endif %}
        {% endfor %}

        <!-- THUMBNAIL IMAGES -->
        {% if node.field_plant_images|length > 0 %}
        <div id="thumb_selector" style="margin-bottom: 20px;">
            <ul class="thumb_album">
                {% for key, item in node.field_plant_images|reverse(true) %}
                    {% set imagestyle = {
                        '#theme':      'image_style',
                        '#style_name': 'nmrp_thumbnail',
                        '#attributes': { class: 'img-responsive img-thumbnail' },
                        '#uri':        node.field_plant_images[key].entity.field_media_image[0].entity.uri.value,
                        }
                    %}
                    <li id="thumb_img_{{ key }}">
                        <a href="{{ file_url(node.field_plant_images[key].entity.field_media_image[0].entity.uri.value) }}" class="nmrp-img" data-copyright='{% if node.field_plant_images[key].entity.field_copyright_date.value != null %}{{ node.field_plant_images[key].entity.field_copyright_date.value|date("Y") }}{% endif %}' 
                           data-photographer="{% if node.field_plant_images[key].entity.field_photographer.value != null %}{{ node.field_plant_images[key].entity.field_photographer.value }}{% endif %}">
                            {{ imagestyle }}
                        </a>
                    </li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}
        <!-- END THUMBNAIL IMAGES -->

        <h1 class="node-page-title">{{ node.title.0.value }}</h1>
        <div class="container-fluid">
            <div class="row">
                <div class="{% if defaultimg %}col-lg-5{% endif %}">
                    <!-- PRIMARY PHOTO -->
                    <figure>
                        <a href="{{ file_url(defaultimg.entity.field_media_image[0].entity.uri.value) }}" class="nmrp-img" 
                           data-copyright='{% if defaultimg.entity.field_copyright_date.value != null %}{{ defaultimg.entity.field_copyright_date.value|date("Y") }}{% endif %}' 
                           data-photographer="{% if defaultimg.entity.field_photographer.value != null %}{{ defaultimg.entity.field_photographer.value }}{% endif %}">
                        {{ {
                            '#theme':      'image_style',
                            '#style_name': 'nmrp_large',
                            '#attributes': { class: 'img-responsive img-thumbnail' },
                            '#uri':        defaultimg.entity.field_media_image[0].entity.uri.value,
                            } }}
                        </a>
                        <figcaption>
                            {% if defaultimg.entity.field_photographer.value != null %}
                            Photograph by <cite>{{ defaultimg.entity.field_photographer.value }}</cite>
                            {% endif %}
                        
                            {% if defaultimg.entity.field_copyright_date.value != null %}
                            ({{ defaultimg.entity.field_copyright_date.value|date("Y") }})
                            {% endif %}
                        </figcaption>
                    </figure>

                    
                </div>
                <div class="{% if defaultimg %}col-lg-7{% else %}col-lg-12{% endif %}">
                    {{  content.field_family }}
                    {{  content.field_scinamewithauthor }}
                    {{  content.field_synonyms }}
                    {{  content.field_commname }}

                    <!-- AGENCY STATUS -->
                    <div class="table-responsive">
                        <table class="table">
                            <caption>Agency Status</caption>
                            <tr>
                                <th data-toggle="tooltip" title="" data-original-title="U.S. Fish and Wildlife Service (USFWS)" data-container="body">USFWS</th>
                                <th data-toggle="tooltip" title="" data-original-title="State of New Mexico (NM)" data-container="body">State of NM</th>
                                <th data-toggle="tooltip" title="" data-original-title="U.S. Forest Service (USFS)" data-container="body">USFS</th>
                                <th data-toggle="tooltip" title="" data-original-title="Bureau of Land Management (BLM)" data-container="body">BLM</th>
                                <th>Navajo Nation</th>
                                <th data-toggle="tooltip" title="" data-original-title="Heritage State Conservation Rank" data-container="body">State Rank</th>
                                <th data-toggle="tooltip" title="" data-original-title="NatureServe Global Conservation Rank" data-container="body">Global Rank</th>
                                <th data-toggle="tooltip" title="" data-original-title="Rarity-Endangerment-Distribution:<br>1 (least), 2, or 3 (most)" data-container="body" data-html="true">R-E-D Code</th>
                                <th data-toggle="tooltip" title="" data-original-title="New Mexico Rare Plant Technical Council (NMRPTC)" data-container="body">NMRPTC Status</th>
                                <th>Strategy Status</th>
                            </tr>
                            <tr>
                                <td data-toggle="tooltip" title="" data-original-title="{{ node.field_fedstatusinnm[0].entity.description.value }}" data-container="body" data-html="true">{{  content.field_fedstatusinnm.0 }}</td>
                                <td data-toggle="tooltip" title="" data-original-title="{{ node.field_agency_statestatus[0].entity.description.value }}" data-container="body" data-html="true">{{  content.field_agency_statestatus.0 }}</td>
                                <td data-toggle="tooltip" title="" data-original-title="{{ node.field_agency_usfs[0].entity.description.value }}" data-container="body" data-html="true">{{  content.field_agency_usfs.0 }}</td>
                                <td data-toggle="tooltip" title="" data-original-title="{{ node.field_agency_blm[0].entity.description.value }}" data-container="body" data-html="true">{{  content.field_agency_blm.0 }}</td>
                                <td data-toggle="tooltip" title="" data-original-title="{{ node.field_agency_navajo[0].entity.description.value }}" data-container="body" data-html="true">{{  content.field_agency_navajo.0 }}</td>
                                <td data-toggle="tooltip" title="" data-original-title="{{ node.field_agency_staterank[0].entity.description.value }}" data-container="body" data-html="true">{{  content.field_agency_staterank.0 }}</td>
                                <td data-toggle="tooltip" title="" data-original-title="{{ node.field_agency_globalrank[0].entity.description.value }}" data-container="body" data-html="true">{{  content.field_agency_globalrank.0 }}</td>
                                <td data-toggle="tooltip" title="" data-original-title="{{ node.field_redcode[0].entity.description.value }}" data-container="body" data-html="true">{{  content.field_redcode.0 }}</td>
                                <td data-toggle="tooltip" title="" data-original-title="{{ node.field_nmrptcstatus[0].entity.description.value }}" data-container="body" data-html="true">{{  content.field_nmrptcstatus.0 }}</td>
                                <td data-toggle="tooltip" title="" data-original-title="{{ node.field_strategy_status[0].entity.description.value }}" data-container="body" data-html="true">{{  content.field_strategy_status.0 }}</td>
                            </tr>
                        </table>
                    </div>

                    <!-- CONSERVATION STATUS-->
                    {% if node.field_strategy_species.0.value == 1 %}
                    <div class="table-responsive">
                        <table class="table">
                            <caption>Conservation Status</caption>
                            <tr>
                                {% if not content.field_strategy_overallstatus.0 == '' %}
                                <th>{{ content.field_strategy_overallstatus['#title'] }}</th>
                                {% endif %}

                                {% if not content.field_strategy_threats.0 == '' %}
                                <th>{{ content.field_strategy_threats['#title'] }}</th>
                                {% endif %}
                
                                {% if not content.field_strategy_actions.0 == '' %}
                                <th>{{ content.field_strategy_actions['#title'] }}</th>
                                {% endif %}
                            </tr>
                            <tr>
                                {% if not content.field_strategy_overallstatus.0 == '' %}
                                <td>{{ content.field_strategy_overallstatus.0 }}</td>
                                {% endif %}

                                {% if not content.field_strategy_threats.0 == '' %}
                                <td>{{ content.field_strategy_threats.0 }}</td>
                                {% endif %}
                
                                {% if not content.field_strategy_actions.0 == '' %}
                                <td>{{ content.field_strategy_actions.0 }}</td>
                                {% endif %}
                
                            </tr>
                        </table>
                    </div>

                    <p><a href="https://nhnm.unm.edu/sites/default/files/nonsensitive/NM_Plant_Score_Card_with_Common_Name.xlsx">Rare Plant Conservation Scorecard Summary</a></p>
                    {% endif %}
                </div>
            </div>
            <div class="row">
                <div class="col-12">
                    <hr/>
                </div>
            </div>
            <div class="row">
                <div class="{% if node.field_county_map.0 %}col-lg-2{% endif %}">
                    <a href="{{ file_url(node.field_county_map.0.entity.uri.value) }}" class="nmrp-img">
                        <img src="{{ file_url(node.field_county_thumbnail.0.entity.uri.value) }}" alt="" />
                    </a>
                    {{ content.field_counties }}
                </div>
                <div class="{% if node.field_county_map.0 %}col-lg-10{% else %}col-lg-12{% endif %}">
                    {{  content.field_description }}
                    {{  content.field_similarspecies }}
                    {{  content.field_distribution }}
                    {{ content.field_habitat }}
                    {{ content.field_remarks }}
                    {{ content.field_conservation }}
                    {{ content.field_important_literature }}
                    {{ content.field_compiler }}

                    {# if node.field_element_subnational_id.0.value != '' #}
                    <p><a target="_blank" href="https://nhnm.unm.edu/bcd/species/{{node.field_element_subnational_id.0.value}}">For distribution maps and more information, visit Natural Heritage New Mexico</a></p>
                    {# endif #}
                    
                </div>
            </div>
        </div>

    </div> <!-- END CONTENT ATTRIBUTES -->

    <!-- IMAGE OVERLAY MODAL -->
    <div id="nmrp-img-overlay" class="modal fade" id="imagemodal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog  modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                </div>
                <div class="modal-body"></div>
                <div class="modal-footer"></div>
            </div>
        </div>
    </div>
    <!-- END IMAGE OVERLAY MODAL -->


    {#

    <h2>Context</h2>
    <ol>
        {% for key, value in _context  %}
            <li>{{ key }}</li>
        {% endfor %}
    </ol>

    <h2>Content</h2>
    <ol>
        {% for key, value in content  %}
            <li>{{ key }}</li>
        {% endfor %}
    </ol>

    <h2>Node</h2>
    <ol>
        {% for key, value in node  %}
            <li>{{ key }}</li>
        {% endfor %}
    </ol>
    #}

</article>

